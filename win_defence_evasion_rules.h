#ifndef FLEET_WIN_DEFENCE_EVASION_RULES_H
#define FLEET_WIN_DEFENCE_EVASION_RULES_H

#include "../common/EdrDataTypes.h"

bool BITS_jobs(const ProcessEvent &process_event, Event &rule_event);
bool escalate_guest(const ProcessEvent &process_event, Event &rule_event);
bool registry_modification(const ProcessEvent &process_event, Event &rule_event);
bool indirect_command_execution(const ProcessEvent &process_event, Event &rule_event);
bool alternate_authentication(const ProcessEvent &process_event, Event &rule_event);
bool indicator_removal(const ProcessEvent &process_event, Event &rule_event);
bool disable_powershell_etw(const ProcessEvent &process_event, Event &rule_event);
bool create_process_with_token(const ProcessEvent &process_event, Event &rule_event);
bool process_hollowing(const ProcessEvent &process_event, Event &rule_event);
bool grant_access_to_C(const ProcessEvent &process_event, Event &rule_event);
bool hide_artifacts(const ProcessEvent &file_event, Event &rule_event);
bool masquerading(const ProcessEvent &process_event, Event &rule_event);
bool proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool bypass_user_account_control(const ProcessEvent &process_event, Event &rule_event);
bool xsl_script_processing(const ProcessEvent &process_event, Event &rule_event);
bool mshta(const ProcessEvent &process_event, Event &rule_event);
bool system_binary_proxy_execution_regsvr32(const ProcessEvent &process_event, Event &rule_event);
bool system_binary_proxy_execution_msiexec(const ProcessEvent &process_event, Event &rule_event);
bool proxy_execution_msbuild(const ProcessEvent &process_event, Event &rule_event);
bool system_binary_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool system_binary_proxy_execution_rundll32(const ProcessEvent &process_event, Event &rule_event);
bool dll_side_loading(const ProcessEvent &process_event, Event &rule_event);
bool ntfs_file_attributes(const ProcessEvent &process_event, Event &rule_event);
bool clear_command_history(const ProcessEvent &process_event, Event &rule_event);
bool obfuscated_files_or_information(const ProcessEvent &process_event, Event &rule_event);
bool process_injection(const ProcessEvent &process_event, Event &rule_event);
bool indicator_removal_file_deletion(const ProcessEvent &process_event, Event &rule_event);
bool hidden_window_hide_artifacts(const ProcessEvent &process_event, Event &rule_event);
bool impair_defenses_disable_modify_tools(const ProcessEvent &process_event, Event &rule_event);
bool install_root_certificate(const ProcessEvent &process_event, Event &rule_event);
bool system_binary_proxy_execution_installutil(const ProcessEvent &process_event, Event &rule_event);
bool decode_files_or_information(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_netwire(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_ursnif(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_terminal_server_client(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_blackbyte(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_load_service_safemode(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_disable_win_registry_tool(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_disable_win_security_notifications(const ProcessEvent &process_event, Event &rule_event);
bool modify_registry_win_group_policy_feature(const ProcessEvent &process_event, Event &rule_event);
bool impair_defenses_disable_modify_tools_AMSI_Byspass(const ProcessEvent &process_event, Event &rule_event);
bool impair_defenses_disable_modify_tools_office_security(const ProcessEvent &process_event, Event &rule_event);
bool impair_defenses_disable_defender_firewall(const ProcessEvent &process_event, Event &rule_event);
bool user_scope_cor_profile(const ProcessEvent &process_event, Event &rule_event);
bool hide_artifacts_through_registry(const ProcessEvent &process_event, Event &rule_event);
bool impair_defenses_tamper_win_defender(const ProcessEvent &process_event, Event &rule_event);
bool install_root_certificate_win_certutil(const ProcessEvent &process_event, Event &rule_event);
bool indicator_removal_del_single_file(const ProcessEvent &process_event, Event &rule_event);
bool powerShell_downgrade_attack(const ProcessEvent &process_event, Event &rule_event);
bool tamper_windows_defender(const ProcessEvent &process_event, Event &rule_event);
bool AMSI_bypass_pattern_assembly_getType(const ProcessEvent &process_event, Event &rule_event);
bool powershell_detect_virtualization_environment(const ProcessEvent &process_event, Event &rule_event);
bool disable_WindowsOptionalFeature_command_powershell(const ProcessEvent &process_event, Event &rule_event);
bool NTFS_alternate_data_stream(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_invoke_item_from_mount_diskImage(const ProcessEvent &process_event, Event &rule_event);
bool powershell_store_file_in_alternate_data_stream(const ProcessEvent &process_event, Event &rule_event);
bool potential_powershell_obfuscation_using_character_join(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_eventlog_clear(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_hyper_v_cmdlets(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_io_fileStream(const ProcessEvent &process_event, Event &rule_event);
bool powershell_deleted_mounted_share(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_unblock_file(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_powershell_windowStyle_option(const ProcessEvent &process_event, Event &rule_event);
bool tamper_windows_defender_ScriptBlockLogging(const ProcessEvent &process_event, Event &rule_event);
bool powershell_timestomp(const ProcessEvent &process_event, Event &rule_event);
bool powershell_WMI_Win32_product_install_MSI(const ProcessEvent &process_event, Event &rule_event);
bool windows_firewall_profile_disabled(const ProcessEvent &process_event, Event &rule_event);
bool regsvr32_network_activity_dns(const ProcessEvent &process_event, Event &rule_event);
bool cmstp_execution_process_access(const ProcessEvent &process_event, Event &rule_event);
bool malware_shellcode_in_verclsid_target_process(const ProcessEvent &process_event, Event &rule_event);
bool potential_shellcode_injection(const ProcessEvent &process_event, Event &rule_event);
bool powershell_decompress_commands(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_RUNDLL_LAUNCHER_powershell_module(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_via_use_mshta_powershell_module(const ProcessEvent &process_event, Event &rule_event);
bool potential_RemoteFXvGPUDisablement_abuse_powershell_module(const ProcessEvent &process_event, Event &rule_event);
bool SyncAppvPublishingServer_bypass_powershell_restriction_PS_module(const ProcessEvent &process_event, Event &rule_event);
bool clearing_windows_console_history(const ProcessEvent &process_event, Event &rule_event);
bool disable_powershell_command_history(const ProcessEvent &process_event, Event &rule_event);
bool potential_in_memory_execution_using_reflection_assembly(const ProcessEvent &process_event, Event &rule_event);
bool potential_RemoteFXvGPUDisablement_EXE_abuse(const ProcessEvent &process_event, Event &rule_event);
bool powershell_script_change_permission_via_set_acl_PsScript(const ProcessEvent &process_event, Event &rule_event);
bool troubleshooting_pack_cmdlet_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_start_process_passthru(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_X509Enrollment_ps_script(const ProcessEvent &process_event, Event &rule_event);
bool network_connection_initiated_by_AddinUtil_EXE(const ProcessEvent &process_event, Event &rule_event);
bool HH_EXE_network_connections(const ProcessEvent &process_event, Event &rule_event);
bool wuauclt_network_connection(const ProcessEvent &process_event, Event &rule_event);
bool load_arbitrary_DLL_via_wuauclt(const ProcessEvent &process_event, Event &rule_event);
bool execute_from_alternate_data_streams(const ProcessEvent &process_event, Event &rule_event);
bool potential_commandline_obfuscation_using_escape_characters(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_clip_plus_launcher(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_obfuscated_iex_invocation(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_stdin_launcher(const ProcessEvent &process_event, Event &rule_event);
bool unmount_share_via_net_exe(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_var_plus_launcher(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_compress_obfuscation(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_via_stdin(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_via_use_clip(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_via_use_mshta(const ProcessEvent &process_event, Event &rule_event);
bool invoke_obfuscation_var_plus_plus_obfuscation(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rasdial_activity(const ProcessEvent &process_event, Event &rule_event);
bool raccine_uninstall(const ProcessEvent &process_event, Event &rule_event);
bool dumpStack_log_defender_evasion(const ProcessEvent &process_event, Event &rule_event);
bool new_firewall_rule_added_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool rdp_connection_allowed_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool firewall_rule_deleted_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool firewall_disabled_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool netsh_allow_group_policy_on_microsoft_defender_firewall(const ProcessEvent &process_event, Event &rule_event);
bool firewall_rule_update_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool ETW_logging_tamper_in_NET_processes(const ProcessEvent &process_event, Event &rule_event);
bool disable_of_ETW_trace(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_execution_from_GUID_like_folder_names(const ProcessEvent &process_event, Event &rule_event);
bool parent_in_public_folder_suspicious_process(const ProcessEvent &process_event, Event &rule_event);
bool potential_hidden_directory_creation_via_NTFS_INDEX_ALLOCATION_stream_CLI(const ProcessEvent &process_event, Event &rule_event);
bool writing_of_malicious_files_to_the_fonts_folder(const ProcessEvent &process_event, Event &rule_event);
bool non_privileged_usage_of_reg_or_powershell(const ProcessEvent &process_event, Event &rule_event);
bool add_safeboot_keys_via_reg_utility(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_localpotato_execution(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_powertool_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_windows_defender_folder_exclusion(const ProcessEvent &process_event, Event &rule_event);
bool safeboot_registry_key_deleted_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool service_registry_key_deleted_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool security_service_disabled_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_registry_file_imported_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool disabled_restrictedadminmode_for_rds(const ProcessEvent &process_event, Event &rule_event);
bool lsa_ppl_protection_disabled_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool modify_group_policy_settings(const ProcessEvent &process_event, Event &rule_event);
bool use_NTFS_short_name_in_command_ine(const ProcessEvent &process_event, Event &rule_event);
bool tampering_with_rdp_related_registry_keys_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool potential_defense_evasion_via_right_to_left_override(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_windows_service_tampering(const ProcessEvent &process_event, Event &rule_event);
bool process_creation_using_sysnative_folder(const ProcessEvent &process_event, Event &rule_event);
bool tasks_folder_evasion(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_userinit_child_process(const ProcessEvent &process_event, Event &rule_event);
bool execution_via_workFolders_exe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_svchost_process(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_ppid_spoofing_selectmyparent_tool_execution(const ProcessEvent &process_event, Event &rule_event);
bool kernel_memory_dump_via_liveKD(const ProcessEvent &process_event, Event &rule_event);
bool potential_sysInternals_procDump_evasion(const ProcessEvent &process_event, Event &rule_event);
bool reg_add_suspicious_paths(const ProcessEvent &process_event, Event &rule_event);
bool disabled_volume_snapshots(const ProcessEvent &process_event, Event &rule_event);
bool write_protect_for_storage_disabled(const ProcessEvent &process_event, Event &rule_event);
bool dll_execution_via_register_cimprovider(const ProcessEvent &process_event, Event &rule_event);
// bool potential_LSASS_process_dump_via_procdump(const ProcessEvent &process_event, Event &rule_event);
bool sysinternals_psSuspend_suspicious_execution(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_sharpevtmute_execution(const ProcessEvent &process_event, Event &rule_event);
bool sysmon_configuration_update(const ProcessEvent &process_event, Event &rule_event);
bool uninstall_sysinternal_sysmon(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_recursive_takeown(const ProcessEvent &process_event, Event &rule_event);
bool taskkill_symantec_endpoint_protection(const ProcessEvent &process_event, Event &rule_event);
bool taskmgr_LOCAL_SYSTEM(const ProcessEvent &process_event, Event &rule_event);
bool potential_provisioning_registry_key_abuse_for_binary_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_powerShell_execution_policy_tampering_proccreation(const ProcessEvent &process_event, Event &rule_event);
bool potential_regsvr32_commandline_flag_anomaly(const ProcessEvent &process_event, Event &rule_event);
bool potentially_suspicious_regsvr32_http_ip_pattern(const ProcessEvent &process_event, Event &rule_event);
bool potentially_suspicious_regsvr32_http_ftp_pattern(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_regsvr32_execution_from_remote_share(const ProcessEvent &process_event, Event &rule_event);
bool potentially_suspicious_child_process_of_regsvr32(const ProcessEvent &process_event, Event &rule_event);
bool regsvr32_execution_from_potential_suspicious_location(const ProcessEvent &process_event, Event &rule_event);
bool regsvr32_dll_execution_with_suspicious_file_extension(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_changePK_and_SLUI(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_disk_cleanup(const ProcessEvent &process_event, Event &rule_event);
bool bypass_UAC_via_CMSTP(const ProcessEvent &process_event, Event &rule_event);
bool cmstp_UAC_bypass_via_COM_object_access(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_tools_using_computerDefaults(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_dismHost(const ProcessEvent &process_event, Event &rule_event);
bool potential_arbitrary_code_execution_via_node_exe(const ProcessEvent &process_event, Event &rule_event);
bool node_process_executions(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_wmiexec_default_powershell_command(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_xordump_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_homoglyph_attack_using_lookalike_characters(const ProcessEvent &process_event, Event &rule_event);
bool bypass_UAC_using_event_viewer_powerShell(const ProcessEvent &process_event, Event &rule_event);
bool bypass_UAC_using_event_viewer_cmd(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_event_viewer_recentViews(const ProcessEvent &process_event, Event &rule_event);
bool scripting_commandline_process_spawned_regsvr32(const ProcessEvent &process_event, Event &rule_event);
bool regsvr32_dll_execution_with_uncommon_extension(const ProcessEvent &process_event, Event &rule_event);
bool remote_access_tool_rurat_execution_from_unusual_location(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_driver_ddl_installation_via_odbccnf_exe(const ProcessEvent &process_event, Event &rule_event);
bool driver_ddl_installation_via_odbccnf_exe(const ProcessEvent &process_event, Event &rule_event);
bool odbcconf_exe_suspicious_dll_location(const ProcessEvent &process_event, Event &rule_event);
bool potentially_suspicious_dll_registered_via_odbcconf_exe(const ProcessEvent &process_event, Event &rule_event);
bool new_dll_registered_via_odbcconf_exe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_response_file_execution_via_odbcconf_exe(const ProcessEvent &process_event, Event &rule_event);
bool response_file_execution_via_odbcconf_exe(const ProcessEvent &process_event, Event &rule_event);
bool uncommon_child_process_spawned_by_odbcconf_exe(const ProcessEvent &process_event, Event &rule_event);
bool potential_arbitrary_file_download_using_office_application(const ProcessEvent &process_event, Event &rule_event);
bool potentially_suspicious_office_document_executed_from_trusted_location(const ProcessEvent &process_event, Event &rule_event);
bool renamed_autohotkeyexe_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_autoit_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_defense_evasion_via_rename_of_highly_relevant_binaries(const ProcessEvent &process_event, Event &rule_event);
// bool potential_defense_evasion_via_binary_rename(const ProcessEvent &process_event, Event &rule_event);
bool renamed_browsercoreexe_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_createdump_utility_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_zoho_dctask64_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_mavinjectexe_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_megasync_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_msdtexe_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_netsupport_rat_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_office_binary_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_paexec_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_plink_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_remote_utilities_rat_rurat_execution(const ProcessEvent &process_event, Event &rule_event);
bool renamed_procdump_execution(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_IEInstal_process(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_MSConfig_token_modification_process(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_using_PkgMgr_and_DISM(const ProcessEvent &process_event, Event &rule_event);
bool uac_bypass_abusing_winsat_path_parsing_process(const ProcessEvent &process_event, Event &rule_event);
bool uninstall_crowdstrike_falcon_sensor(const ProcessEvent &process_event, Event &rule_event);
bool verclsid_exe_runs_COM_object(const ProcessEvent &process_event, Event &rule_event);
bool detect_virtualbox_driver_installation_OR_starting_of_VMs(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_VBoxDrvInst_exe_parameters(const ProcessEvent &process_event, Event &rule_event);
bool vsCode_child_process_anomaly(const ProcessEvent &process_event, Event &rule_event);
bool potential_binary_proxy_execution_via_VSDiagnostics_EXE(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_vsls_agent_command_with_agentExtensionPath_load(const ProcessEvent &process_event, Event &rule_event);
bool potential_arbitrary_dll_load_using_winword(const ProcessEvent &process_event, Event &rule_event);
bool ping_hex_ip(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_powercfg_execution_to_change_lock_screen_timeout(const ProcessEvent &process_event, Event &rule_event);
bool potential_amsi_bypass_via_net_reflection(const ProcessEvent &process_event, Event &rule_event);
bool potential_amsi_bypass_using_null_bits(const ProcessEvent &process_event, Event &rule_event);
bool powershell_base64_encoded_frombase64string_cmdlet(const ProcessEvent &process_event, Event &rule_event);
bool powershell_base64_encoded_mppreference_cmdlet(const ProcessEvent &process_event, Event &rule_event);
bool potential_process_execution_proxy_via_cl_invocation_ps1(const ProcessEvent &process_event, Event &rule_event);
bool assembly_loading_via_cl_loadassembly_ps1(const ProcessEvent &process_event, Event &rule_event);
bool potential_script_proxy_execution_via_cl_mutexverifiers_ps1(const ProcessEvent &process_event, Event &rule_event);
bool convertto_securestring_cmdlet_usage_via_commandline(const ProcessEvent &process_event, Event &rule_event);
bool potential_powershell_obfuscation_via_reversed_commands(const ProcessEvent &process_event, Event &rule_event);
bool fake_instance_of_hxtsr(const ProcessEvent &process_event, Event &rule_event);
bool use_icacls_to_hide_file_to_everyone(const ProcessEvent &process_event, Event &rule_event);
bool disable_windows_iis_http_logging(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_iis_url_globalrules_rewrite_via_appcmd(const ProcessEvent &process_event, Event &rule_event);
bool powershell_defender_disable_scan_feature(const ProcessEvent &process_event, Event &rule_event);
bool powershell_defender_exclusion(const ProcessEvent &process_event, Event &rule_event);
bool renamed_vmnatexe_execution(const ProcessEvent &process_event, Event &rule_event);
bool disable_windows_defender_av_security_monitoring(const ProcessEvent &process_event, Event &rule_event);
bool windows_firewall_disabled_via_powershell(const ProcessEvent &process_event, Event &rule_event);
bool disabled_ie_security_features(const ProcessEvent &process_event, Event &rule_event);
bool potential_powershell_execution_via_dll(const ProcessEvent &process_event, Event &rule_event);
bool potential_powershell_downgrade_attack(const ProcessEvent &process_event, Event &rule_event);
bool potential_suspicious_windows_feature_enabled(const ProcessEvent &process_event, Event &rule_event);
bool potential_encoded_powershell_patterns_in_commandline(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_advpack_call_via_rundll32exe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_call_by_ordinal(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rundll32_invoking_inline_vbScript(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_installscreensaver_execution(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_js_runhtmlapplication_pattern(const ProcessEvent &process_event, Event &rule_event);
bool imagingdevices_unusual_parentchild_processes(const ProcessEvent &process_event, Event &rule_event);
bool infdefaultinstallexe_inf_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_execution_of_installutil_without_log(const ProcessEvent &process_event, Event &rule_event);
bool windows_kernel_debugger_execution(const ProcessEvent &process_event, Event &rule_event);
bool base64_encoded_powershell_command_detected(const ProcessEvent &process_event, Event &rule_event);
bool root_certificate_installed_from_susp_locations(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_powershell_invocations(const ProcessEvent &process_event, Event &rule_event);
bool remotefxvgpudisablement_abuse_via_atomictestharnesses(const ProcessEvent &process_event, Event &rule_event);
bool run_powershell_script_from_ads(const ProcessEvent &process_event, Event &rule_event);
bool mshtml_dll_runhtmlapplication_abuse(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_execution_without_commandline_parameters(const ProcessEvent &process_event, Event &rule_event);
bool potential_obfuscated_ordinal_call_via_rundll32(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_spawned_via_explorerexe(const ProcessEvent &process_event, Event &rule_event);
bool process_memory_dump_via_comsvcsdll(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_windows_trace_etw_session_tamper_via_logmanexe(const ProcessEvent &process_event, Event &rule_event);
bool using_appvlp_to_circumvent_asr_file_path_rule(const ProcessEvent &process_event, Event &rule_event);
bool custom_class_execution_via_xwizard(const ProcessEvent &process_event, Event &rule_event);
bool potential_reflectDebugger_content_execution_via_werFault_EXE(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_child_process_of_wermgr_EXE(const ProcessEvent &process_event, Event &rule_event);
bool powershell_set_acl_on_windows_folder(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_customshellhost_execution(const ProcessEvent &process_event, Event &rule_event);
bool zoho_dctask64_process_injection(const ProcessEvent &process_event, Event &rule_event);
bool lolbin_defaultpackexe_use_as_proxy(const ProcessEvent &process_event, Event &rule_event);
bool devicecredentialdeployment_execution(const ProcessEvent &process_event, Event &rule_event);
bool devtoollauncherexe_executes_specified_binary(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_diantz_alternate_data_stream_execution(const ProcessEvent &process_event, Event &rule_event);
bool xwizard_dll_sideloading(const ProcessEvent &process_event, Event &rule_event);
bool application_whitelisting_bypass_via_dnxexe(const ProcessEvent &process_event, Event &rule_event);
bool process_memory_dump_via_dotnet_dump(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_extexport_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_extrac32_alternate_data_stream_execution(const ProcessEvent &process_event, Event &rule_event);
bool abusing_findstr_for_defence_evasion(const ProcessEvent &process_event, Event &rule_event);
bool formatcom_filesystem_lolbin(const ProcessEvent &process_event, Event &rule_event);
bool powershell_script_change_permission_via_set_acl(const ProcessEvent &process_event, Event &rule_event);
bool service_startuptype_change_via_powershell_set_service(const ProcessEvent &process_event, Event &rule_event);
bool tamper_windows_defender_remove_mppreference(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_process_start_locations(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rundll32_script_in_commandline(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rundll32_setupapidll_activity(const ProcessEvent &process_event, Event &rule_event);
bool shell32_dll_execution_in_suspicious_directory(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_spawning_explorer(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_control_panel_dll_load(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rundll32_execution_with_image_extension(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_usage_of_shellexec_rundll(const ProcessEvent &process_event, Event &rule_event);
bool shimcache_flush(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_rundll32_activity_invoking_sys_file(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_unc_path_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_workstation_locking_via_rundll32(const ProcessEvent &process_event, Event &rule_event);
bool run_once_task_execution_as_configured_in_registry(const ProcessEvent &process_event, Event &rule_event);
bool awl_bypass_with_winrm_vbs_and_malicious_wsmPty_xsl_wsmTxt_xsl(const ProcessEvent &process_event, Event &rule_event);
bool remote_code_execute_via_winrm_vbs(const ProcessEvent &process_event, Event &rule_event);
bool tamper_with_windows_defender_using_command_prompt(const ProcessEvent &process_event, Event &rule_event);
bool abusing_print_executable(const ProcessEvent &process_event, Event &rule_event);
bool potential_provlaunch_exe_binary_proxy_execution_abuse(const ProcessEvent &process_event, Event &rule_event);
bool pua_cleanwipe_execution(const ProcessEvent &process_event, Event &rule_event);
bool pua_potential_pe_metadata_tamper_using_rcedit(const ProcessEvent &process_event, Event &rule_event);
bool gpscript_execution(const ProcessEvent &process_event, Event &rule_event);
bool ie4uinit_lolbin_use_from_invalid_path(const ProcessEvent &process_event, Event &rule_event);
bool ilasm_lolbin_use_compile_c_sharp(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_execution_of_installutil_to_download(const ProcessEvent &process_event, Event &rule_event);
bool jsc_convert_javascript_to_executable(const ProcessEvent &process_event, Event &rule_event);
bool kavremover_dropped_binary_lolbin_usage(const ProcessEvent &process_event, Event &rule_event);
bool launch_vsdevshellps1_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_manage_bdewsf_abuse_to_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool mavinject_inject_dll_into_running_process(const ProcessEvent &process_event, Event &rule_event);
bool execute_msdt_via_answer_file(const ProcessEvent &process_event, Event &rule_event);
bool downlaod_arbitrary_files_via_msohtmedexe(const ProcessEvent &process_event, Event &rule_event);
bool abitrary_file_download_viamspuexe(const ProcessEvent &process_event, Event &rule_event);
bool openwitexe_executes_specified_binary(const ProcessEvent &process_event, Event &rule_event);
bool execute_pcwrunexe_to_leverage_follina(const ProcessEvent &process_event, Event &rule_event);
bool indirect_command_execution_by_program_compatibility_wizard(const ProcessEvent &process_event, Event &rule_event);
bool code_execution_via_pcwutldll(const ProcessEvent &process_event, Event &rule_event);
bool downlaod_arbitrary_files_via_presentationhostexe(const ProcessEvent &process_event, Event &rule_event);
bool application_whitelisting_bypass_via_presentationhostexe(const ProcessEvent &process_event, Event &rule_event);
bool file_download_using_protocol_handle(const ProcessEvent &process_event, Event &rule_event);
bool pubprnvbs_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool dll_execution_via_rasautouexe(const ProcessEvent &process_event, Event &rule_event);
bool registerappvbs_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool use_of_remoteexe(const ProcessEvent &process_event, Event &rule_event);
bool lolbin_runexehelper_use_as_proxy(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_runscripthelperexe(const ProcessEvent &process_event, Event &rule_event);
bool using_settingsynchostexe_as_lolbin(const ProcessEvent &process_event, Event &rule_event);
bool use_of_sftpexe_binary_as_lolbin(const ProcessEvent &process_event, Event &rule_event);
bool sideloading_linkexe(const ProcessEvent &process_event, Event &rule_event);
bool lolbin_sshexe_use_as_proxy(const ProcessEvent &process_event, Event &rule_event);
bool use_of_squirrelexe(const ProcessEvent &process_event, Event &rule_event);
bool use_of_scriptrunnerexe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_atbroker_execution(const ProcessEvent &process_event, Event &rule_event);
bool application_whitelisting_bypass_via_dxcapexe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_scheduled_task_creation_via_masqueraded_xml_file(const ProcessEvent &process_event, Event &rule_event);
bool sdiagnhost_calling_suspicious_child_process(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_splwow64_without_params(const ProcessEvent &process_event, Event &rule_event);
bool execution_via_stordiagexe(const ProcessEvent &process_event, Event &rule_event);
bool start_of_nt_virtual_dos_machine(const ProcessEvent &process_event, Event &rule_event);
bool potential_tampering_with_security_products_via_wmic(const ProcessEvent &process_event, Event &rule_event);
bool xsl_script_processing(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_windows_defender_registry_key_tampering_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool windows_defender_download_activity(const ProcessEvent &process_event, Event &rule_event);
bool syncappvpublishingserver_execute_arbitrary_powershell_code(const ProcessEvent &process_event, Event &rule_event);
bool syncappvpublishingserver_vbs_execute_arbitrary_powershell_code(const ProcessEvent &process_event, Event &rule_event);
bool potential_dll_injection_or_execution_using_trackerexe(const ProcessEvent &process_event, Event &rule_event);
bool use_of_ttdinjectexe(const ProcessEvent &process_event, Event &rule_event);
bool time_travel_debugging_utility_usage(const ProcessEvent &process_event, Event &rule_event);
bool lolbin_unregmp2exe_use_as_proxy(const ProcessEvent &process_event, Event &rule_event);
bool utilityfunctionsps1_proxy_dll(const ProcessEvent &process_event, Event &rule_event);
bool visual_basic_command_line_compiler_usage(const ProcessEvent &process_event, Event &rule_event);
bool use_of_visualuiaverifynativeexe(const ProcessEvent &process_event, Event &rule_event);
bool use_of_vsiisexelauncherexe(const ProcessEvent &process_event, Event &rule_event);
bool use_of_wfcexe(const ProcessEvent &process_event, Event &rule_event);
bool wlrmdr_lolbin_use_as_launcher(const ProcessEvent &process_event, Event &rule_event);
bool microsoft_workflow_compiler_execution(const ProcessEvent &process_event, Event &rule_event);
bool proxy_execution_via_wuauclt(const ProcessEvent &process_event, Event &rule_event);
bool potential_register_appvbs_lolscript_abuse(const ProcessEvent &process_event, Event &rule_event);
bool potential_mftraceexe_abuse(const ProcessEvent &process_event, Event &rule_event);
bool potential_mpclientdll_sideloading_via_defender_binaries(const ProcessEvent &process_event, Event &rule_event);
bool regasm_regsvcs_suspicious_execution(const ProcessEvent &process_event, Event &rule_event);
bool addinutil_commandline_execution(const ProcessEvent &process_event, Event &rule_event);
bool potentital_adplus_abuse(const ProcessEvent &process_event, Event &rule_event);
bool agentexecutor_powershell(const ProcessEvent &process_event, Event &rule_event);
bool aspnetcompiler_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_child_process_aspnetcompiler(const ProcessEvent &process_event, Event &rule_event);
bool potential_suspicious_compilation_aspnet(const ProcessEvent &process_event, Event &rule_event);
bool set_files_system_files_attrib(const ProcessEvent &process_event, Event &rule_event);
bool hide_files_attrib(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_files_system_files_attrib(const ProcessEvent &process_event, Event &rule_event);
bool audit_policy_tampering_via_NT_resource(const ProcessEvent &process_event, Event &rule_event);
bool audit_policy_tampering_auditpol(const ProcessEvent &process_event, Event &rule_event);
bool indirect_inline_command_execution_bash(const ProcessEvent &process_event, Event &rule_event);
bool indirect_command_execution_script_bash(const ProcessEvent &process_event, Event &rule_event);
bool potenital_ransomware_bcdedit(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_child_bginfo(const ProcessEvent &process_event, Event &rule_event);
bool uncommon_child_bginfo(const ProcessEvent &process_event, Event &rule_event);
bool file_download_bitsadmin(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_download_ip_bitsadmin(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_download_file_sharing_bitsadmin(const ProcessEvent &process_event, Event &rule_event);
bool file_download_suspicious_extension_bitsadmin(const ProcessEvent &process_event, Event &rule_event);
bool file_download_bitsadmin_suspicious_target_folder(const ProcessEvent &process_event, Event &rule_event);
bool file_download_bitsadmin_uncommon_target_folder(const ProcessEvent &process_event, Event &rule_event);
bool monitoring_persistence_bits(const ProcessEvent &process_event, Event &rule_event);
bool new_root_certificate_certmgr(const ProcessEvent &process_event, Event &rule_event);
bool dll_loaded_certoc(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_dll_loaded_certoc(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_download_certutil(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_download_certutil_ip(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_file_download_certutil_file_sharing(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_file_encoded_base64_certutil(const ProcessEvent &process_event, Event &rule_event);
bool file_in_suspicious_location_cerutil(const ProcessEvent &process_event, Event &rule_event);
bool certificate_exported_certutil(const ProcessEvent &process_event, Event &rule_event);
bool potential_ntlm_coercion_certutil(const ProcessEvent &process_event, Event &rule_event);
bool greedy_file_deletion_using_del(const ProcessEvent &process_event, Event &rule_event );
bool ping_copy_command_combination(const ProcessEvent &process_event, Event &rule_event);
bool ping_del_command_combination(const ProcessEvent &process_event, Event &rule_event);
bool directory_removal_rmdir(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_high_integrity_level_conhost_legacy_option(const ProcessEvent &process_event, Event &rule_event);
bool createdump_process_dump(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_csi_usage(const ProcessEvent &process_event, Event &rule_event);
bool potential_dll_sideloading_deviceenroller(const ProcessEvent &process_event, Event &rule_event);
bool arbitrary_msi_download_devinit(const ProcessEvent &process_event, Event &rule_event);
bool dns_serverlevelplugindll_dnscmd(const ProcessEvent &process_event, Event &rule_event);
bool dism_remove_online_package(const ProcessEvent &process_event, Event &rule_event);
bool dumpminitool_execution(const ProcessEvent &process_event, Event &rule_event);
bool explorer_process_tree_break(const ProcessEvent &process_event, Event &rule_event);
bool findstr_lnk_file(const ProcessEvent &process_event, Event &rule_event);
bool fsutil_sus_invocation(const ProcessEvent &process_event, Event &rule_event);
bool remote_chm_file_download_hh_exe(const ProcessEvent &process_event, Event &rule_event);
bool html_help_hh_exe_child_process(const ProcessEvent &process_event, Event &rule_event);
bool sus_hh_execution(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_c3_load_rundll32(const ProcessEvent &process_event,Event &rule_event);
bool cobaltstrike_load_rundll32(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_dinjector_powershell_cradle_execution(const ProcessEvent &process_event, Event &rule_event);
bool pikabot_fake_dll(const ProcessEvent &process_event, Event &rule_event);
bool pikabot_infection_via_sus_cmd_combination(const ProcessEvent &process_event, Event &rule_event);
bool qakbot_execution(const ProcessEvent &process_event, Event &rule_event);
bool qakbot_process_tree_execution(const ProcessEvent &process_event, Event &rule_event);
bool raspberry_robin_msi_installation(const ProcessEvent &process_event, Event &rule_event);bool netsupport_execution_from_unusual_location(const ProcessEvent &process_event, Event &rule_event);
bool usage_of_winrs(const ProcessEvent &process_event, Event &rule_event);
bool mshta_proxy_execution(const ProcessEvent &process_event, Event &rule_event);
bool rundll32_execution_with_dllregisterserver_command_line(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_parent_process_of_rundll32(const ProcessEvent &process_event, Event &rule_event);
bool file_permissions_modification(const ProcessEvent &process_event, Event &rule_event);
bool hiding_local_user_accounts(const ProcessEvent &process_event, Event &rule_event);
bool registry_export_via_gui_or_cli_utility(const ProcessEvent &process_event, Event &rule_event);
bool common_injected_process_with_empty_command_line(const ProcessEvent &process_event, Event &rule_event);
bool event_log_cleared_via_wevtutil(const ProcessEvent &process_event, Event &rule_event);
bool anti_forensic_deletion_tampering_or_size_reduction_of_USN_journal(const ProcessEvent &process_event, Event &rule_event);
bool suspcious_certUtil_execution(const ProcessEvent &process_event, Event &rule_event);

#endif // FLEET_WIN_DEFENCE_EVASION_RULES_H
