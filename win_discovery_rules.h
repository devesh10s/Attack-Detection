#ifndef FLEET_WIN_DISCOVERY_RULES_H
#define FLEET_WIN_DISCOVERY_RULES_H

#include "../common/EdrDataTypes.h"

bool group_policy_discovery(const ProcessEvent &process_event, Event &rule_event);
bool account_discovery_domain_account(const ProcessEvent &process_event, Event &rule_event);
bool browser_information_discovery(const ProcessEvent &process_event, Event &rule_event);
bool system_information_discovery(const ProcessEvent &process_event, Event &rule_event);
bool domain_trust_discovery(const ProcessEvent &process_event, Event &rule_event);
bool file_and_directory_discovery(const ProcessEvent &process_event, Event &rule_event);
bool win_security_software_discovery(const ProcessEvent &process_event, Event &rule_event);
//
bool discover_system_language_chcp(const ProcessEvent &process_event, Event &rule_event);
bool use_get_net_tcp_connection(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_get_local_groups_information(const ProcessEvent &process_event, Event &rule_event);
bool directorySearcher_powershell_exploitation(const ProcessEvent &process_event, Event &rule_event);
bool active_directory_computers_enumeration_with_get_AdComputer(const ProcessEvent &process_event, Event &rule_event);
bool active_directory_computers_enumeration_with_get_AdGroup(const ProcessEvent &process_event, Event &rule_event);
bool security_software_discovery_by_powershell(const ProcessEvent &process_event, Event &rule_event);
bool windows_software_discovery_powershell(const ProcessEvent &process_event, Event &rule_event);
bool password_policy_discovery_with_Get_AdDefaultDomainPasswordPolicy(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_powershell_get_current_user(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_process_discovery_with_get_process(const ProcessEvent &process_event, Event &rule_event);
bool powershell_suspicious_win32_PnPEntity(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_get_information_for_SMB_share_powershell_module(const ProcessEvent &process_event, Event &rule_event);
bool get_ADUser_enumeration_using_UserAccountControl_flags(const ProcessEvent &process_event, Event &rule_event);
bool computer_discovery_and_export_via_get_ADComputer_cmdlet_powershell(const ProcessEvent &process_event, Event &rule_event);
bool powershell_sensitive_file_discovery(const ProcessEvent &process_event, Event &rule_event);
bool ad_groups_or_users_enumeration_using_powershell_scriptblock(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_group_and_account_reconnaissance_activity_using_net_exe(const ProcessEvent &process_event, Event &rule_event);
bool system_network_connections_discovery_via_net_exe(const ProcessEvent &process_event, Event &rule_event);
bool share_and_session_enumeration_using_net_exe(const ProcessEvent &process_event, Event &rule_event);
bool file_and_directory_discovery(const ProcessEvent &process_event, Event &rule_event);
bool win_security_software_discovery(const ProcessEvent &process_event, Event &rule_event);
bool adidnsdump_execution(const ProcessEvent &process_event, Event &rule_event);
bool net_exe_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_firewall_configuration_discovery_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool new_network_trace_capture_started_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_reconnaissance_activity_via_GatherNetworkInfo_VBS(const ProcessEvent &process_event, Event &rule_event);
bool local_accounts_discovery(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_network_command(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_scan_loop_network(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_query_of_machineguid(const ProcessEvent &process_event, Event &rule_event);
bool configuration_and_service_reconnaissance_via_regexe(const ProcessEvent &process_event, Event &rule_event);
bool obfuscated_IP_download(const ProcessEvent &process_event, Event &rule_event);
bool whoami_as_parameter(const ProcessEvent &process_event, Event &rule_event);
bool permission_check_via_accesschk_EXE(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_sharpldapmonitor_execution(const ProcessEvent &process_event, Event &rule_event);
bool detected_windows_software_discovery(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_use_of_PsLogList(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_sharpldapwhoami_execution(const ProcessEvent &process_event, Event &rule_event);
bool hacktool_sharpview_execution(const ProcessEvent &process_event, Event &rule_event);
bool system_information_discovery(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_tasklist_discovery_command(const ProcessEvent &process_event, Event &rule_event);
bool harvesting_of_wifi_credentials_via_netsh_exe(const ProcessEvent &process_event, Event &rule_event);
bool nltest_exe_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_recon_activity_via_nltest_exe(const ProcessEvent &process_event, Event &rule_event);
bool network_reconnaissance_activity(const ProcessEvent &process_event, Event &rule_event);
bool discovery_of_a_system_time(const ProcessEvent &process_event, Event &rule_event);
bool renamed_adfind_execution(const ProcessEvent &process_event, Event &rule_event);
// bool use_of_W32tm_as_timer(const ProcessEvent &process_event, Event &rule_event) ;
bool potential_active_directory_enumeration_using_ad_module(const ProcessEvent &process_event, Event &rule_event);
bool computer_discovery_and_export_via_get_adcomputer_cmdlet(const ProcessEvent &process_event, Event &rule_event);
bool renamed_whoami_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_reconnaissance_activity_using_get_localgroupmember_cmdlet(const ProcessEvent &process_event, Event &rule_event);
bool potential_recon_activity_using_wevtutil(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_where_execution(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_whoami_EXE_execution_from_privileged_process(const ProcessEvent &process_event, Event &rule_event);
bool group_membership_reconnaissance_via_whoami_EXE(const ProcessEvent &process_event, Event &rule_event);
bool user_directory_and_export_via_get_aduser_cmdlet(const ProcessEvent &process_event, Event &rule_event);
bool scexe_query_execution(const ProcessEvent &process_event, Event &rule_event);
bool security_privileges_enumeration_via_whoami_EXE(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_whoami_EXE_execution(const ProcessEvent &process_event, Event &rule_event);
bool local_groups_reconnaissance_via_wmic_EXE(const ProcessEvent &process_event, Event &rule_event);
bool pua_suspicious_activedirectory_enumeration_via_adfindexe(const ProcessEvent &process_event, Event &rule_event);
bool pua_adfind_suspicious_execution(const ProcessEvent &process_event, Event &rule_event);
bool pua_advanced_ip_scanner_execution(const ProcessEvent &process_event, Event &rule_event);
bool pua_advanced_port_scanner_execution(const ProcessEvent &process_event, Event &rule_event);
bool pua_seatbelt_execution(const ProcessEvent &process_event, Event &rule_event);
bool potential_reconnaissance_activity_via_gathernetworkinfovbs(const ProcessEvent &process_event, Event &rule_event);
bool potential_suspicious_activity_using_secedit(const ProcessEvent &process_event, Event &rule_event);
bool powershell_directory_enumeration(const ProcessEvent &process_event, Event &rule_event);
bool files_subdirectories_dir(const ProcessEvent &process_event, Event &rule_event);
bool dirlister_execution(const ProcessEvent &process_event, Event &rule_event);
bool domain_trust_discovery_dsquery(const ProcessEvent &process_event, Event &rule_event);
bool kernel_dump_dtrace(const ProcessEvent &process_event, Event &rule_event);
bool suspicious_findstr_execution(const ProcessEvent &process_event, Event &rule_event);
bool sysmon_discovery_findstr(const ProcessEvent &process_event, Event &rule_event);
bool fsutil_drive_enumeration(const ProcessEvent &process_event, Event &rule_event);
bool gpresult_display_group_policy_information(const ProcessEvent &process_event, Event &rule_event);
bool potential_pikabot_discovery(const ProcessEvent &process_event, Event &rule_event);
bool soaphound_commands_execution(const ProcessEvent &process_event, Event &rule_event);
bool discovery_activity_from_socgholish_malware(const ProcessEvent &process_event, Event &rule_event);
bool users_groups_and_shares_discovery_via_powerview(const ProcessEvent &process_event, Event &rule_event);
bool domain_trust_discovery_via_nltest(const ProcessEvent &process_event, Event &rule_event);
#endif
